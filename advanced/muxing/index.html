<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="2.4.0.727387813250">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 2.4.0">

    <!-- Primary Meta Tags -->
    <title>Muxing</title>
    <meta name="title" content="Muxing">
    <meta name="description" content="Matroska(mkv) is a very versatile container. It can contain multiple streams of video, audio, subtitles, and other attachments." />

    <!-- Canonical -->
    <link rel="canonical" href="https://beta.thewiki.moe/advanced/muxing/" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://beta.thewiki.moe/advanced/muxing/">
    <meta property="og:title" content="Muxing">
    <meta property="og:description" content="Matroska(mkv) is a very versatile container. It can contain multiple streams of video, audio, subtitles, and other attachments.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://beta.thewiki.moe/advanced/muxing/">
    <meta property="twitter:title" content="Muxing">
    <meta property="twitter:description" content="Matroska(mkv) is a very versatile container. It can contain multiple streams of video, audio, subtitles, and other attachments.">

    <script>(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../resources/css/retype.css?v=2.4.0.727387813250" rel="stylesheet" />

    <script type="text/javascript" src="../../resources/js/config.js?v=2.4.0.727387813250" data-turbo-eval="false" defer></script>
    <script type="text/javascript" src="../../resources/js/retype.js?v=2.4.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" type="text/javascript" src="../../resources/js/lunr.js?v=2.4.0.727387813250" data-turbo-eval="false" defer></script>
    <script id="prism-js" type="text/javascript" src="../../resources/js/prism.js?v=2.4.0.727387813250" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between grow pr-6 md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../" class="flex items-center leading-snug text-2xl">
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">The Wiki</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
        
                            <input class="w-full h-10 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 placeholder-gray-400 dark:placeholder-dark-400"
                            style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search" />
                        </div>
        
                        <!-- Mobile search button mock -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placehokder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button mock -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter" />
                </div>
            
                <div class="pl-6 mb-4 mt-1">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="grow min-w-0 px-6 md:px-16">
                        <main class="relative pt-6 pb-16">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                
                                <!-- Page content  -->
<doc-anchor-target id="muxing" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#muxing">#</doc-anchor-trigger>
        <span>Muxing</span>
    </h1>
</doc-anchor-target>
<p>Matroska(mkv) is a very versatile container. It can contain multiple streams of video, audio, subtitles, and other attachments. The process of taking these streams, adding or removing some, and bundling them into a new mkv is called muxing. In general, you could be muxing any format, but for anime we&#x27;ll mostly be dealing with mkv. It&#x27;s useful when you want to use subtitles from a different release with what you already have downloaded, or to remove the extra english audio tracks to save space. Note that this is a lossless process different from encoding and takes only a few seconds.</p>
<p><a href="https://mkvtoolnix.download/">Mkvtoolnix</a> is the best tool for all kinds of muxing. The equivalent cli option is mkvmerge (installed with mkvtoolnix) or ffmpeg. The process can also be done in batch for a whole folder at once. Example (paste in cmd in that folder) -</p>
<p><code v-pre>FOR /F &quot;tokens=*&quot; %G IN ( 'dir /b *.mkv ') DO ffmpeg -n -i &quot;%G&quot; -map 0:v:0 -map 0:a:1 -map 0:s:2 -map 0:t? -c copy &quot;%~nG .mkv&quot;</code></p>
<p>This will copy the first video, second audio, third subtitle stream and all attachments, which are usually the japanese ones in dual audio releases. You can check the stream number with mediainfo. The index starts from zero so <code v-pre>-map 0:s:0</code> would select the first subtitle stream. <code v-pre>-map 0:t?</code> copies the attachments(fonts) if any exist. Understanding more about the <a href="https://trac.ffmpeg.org/wiki/Map">ffmpeg map option</a> is helpful here as that is the only part you need to change.</p>
<doc-anchor-target id="video">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#video">#</doc-anchor-trigger>
        <span>Video</span>
    </h2>
</doc-anchor-target>
<p>Ideally, the video should be an encode that&#x27;s an improvement over the source video but realistically that isn&#x27;t always the case since sometimes no good encode exists. This guide won&#x27;t be tackling the topic of encoding since there&#x27;s already one <a href="https://guide.encode.moe/encoding/preparation.html">here</a>.</p>
<doc-anchor-target id="general">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#general">#</doc-anchor-trigger>
        <span>General</span>
    </h3>
</doc-anchor-target>
<ul>
<li>WEB-DLs are usually the best source for shows which haven&#x27;t gotten a BluRay (usually airing or recently ended).</li>
<li>An encode of the BluRay that&#x27;s better than the source will trump the source.</li>
<li>BluRay Remux trumps WEB-DL/WEBRip and Bad Encodes.</li>
<li>Avoid mini encodes as these are targeted to save size by sacrificing quality. Some popular mini encode groups to avoid are:</li>
</ul>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">Anime Time, AnimeKaizoku, AnimeRG, BakedFish, Bonkai, CBB/CherryBomB, Cleo, DB, DeadFish,
Edge, EMBER, Hakata Ramen, Hi10, iPUNISHER, Judas, Kanjouteki, M@nI, MiniFreeza,
MiniTheatre, Mr.Deadpool, NemDiggers, NoobSubs, project-gxs, SSA, youshikibi</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="video-source">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#video-source">#</doc-anchor-trigger>
        <span>Video Source</span>
    </h3>
</doc-anchor-target>
<p>Unless you are making your own encode, you&#x27;ll have to stick to the available options. To get started:</p>
<ul>
<li>Download the different raws/encodes you find along with the source (BDMV/Remux) and make a <a href="../../tutorials/comparison/">comparison</a>.</li>
<li>Look at the comparison to decide the best source and if you are having trouble picking one, feel free to join the <a href="https://discord.com/invite/jPeeZewWRn">SeaDex Discord</a> where pixel peepers will check it out and help you decide.</li>
</ul>
<doc-anchor-target id="audio">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#audio">#</doc-anchor-trigger>
        <span>Audio</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="recommended-tools">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#recommended-tools">#</doc-anchor-trigger>
        <span>Recommended Tools</span>
    </h3>
</doc-anchor-target>
<ul>
<li><a href="https://forum.doom9.org/showthread.php?t=125966">eac3to</a> with <a href="https://mega.nz/#!dFAmEC4Y!WMTQvzLkfTDHPfhTXURSLaFWbmDMVaq3dKfk4ucjYrI">updated libraries</a> for extracting and transcoding.</li>
<li><a href="http://sox.sourceforge.net/">SoX</a> for resampling and bit depth reduction.</li>
<li><a href="https://opus-codec.org/downloads/">opus-tools</a> for transcoding lossless audio to Opus.</li>
<li><a href="https://github.com/OrangeChannel/acsuite">acsuite</a> for frame-based cutting/trimming/splicing of audio files using VapourSynth clip information.</li>
<li><a href="https://github.com/alopatindev/sync-audio-tracks">sync-audio-tracks</a> calculates a delay between two audios and produces a shifted audio.</li>
<li><a href="https://gitlab.com/beep_street/downsampler-threaded">downsampler-threaded</a> is a multi-process sox frontend for automatically resampling FLAC files.</li>
</ul>
<doc-anchor-target id="general-1">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#general-1">#</doc-anchor-trigger>
        <span>General</span>
    </h3>
</doc-anchor-target>
<p>Either lossless or lossy audio can be used for a good release but with a few things to keep in mind:</p>
<ul>
<li>Avoid including the lossless audio tracks like PCM, DTS-HD, DTS-HD MA, and TrueHD from BDMVs/Remuxes. These tracks should always be transcoded to either FLAC (lossless compression) or a lossy codec with appropriate bitrate.
<ul>
<li><strong>Note</strong>: <em>Do not transcode object-based codecs like DTS:X or Dolby Atmos to FLAC as Dolby Atmos is an extension to TrueHD and DTS:X is an extension to DTS-HD MA. Their metadata will be ignored or stripped out during conversion.</em></li>
</ul>
</li>
<li>Audio tracks should either be converted to 16-bit FLAC because 24-bit FLAC is bloated with no benefits or to a lossy audio codec like Opus with an appropriate bitrate like 128-192Kb/s for Stereo tracks and 256-320Kb/s for multi-channel tracks to achieve transparency.</li>
<li>Never downmix multichannel audio to stereo.</li>
<li>Never transcode a lossy track.</li>
</ul>
<doc-anchor-target id="eac3to">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#eac3to">#</doc-anchor-trigger>
        <span>eac3to</span>
    </h3>
</doc-anchor-target>
<p>Once you have eac3to with updated libraries, you can start with this simple command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">eac3to ExampleAnime.mkv</code></pre>
</doc-codeblock></div>
<p>Or, if it&#x27;s a BDMV</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">eac3to /path/to/BDMV/</code></pre>
</doc-codeblock></div>
<p>This will return all the tracks in the file.</p>
<p>For example:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">D:\MHA&gt;eac3to &quot;My Hero Academia the Movie- The Heroes Rising 2018 1080p BluRay Hybrid-REMUX AVC TrueHD 5.1 Dual Audio -ZR-.mkv&quot;
MKV, 1 video track, 3 audio tracks, 3 subtitle tracks, 1:44:09, 24p /1.001
1: h264/AVC, English, 1080p24 /1.001 (16:9)
2: TrueHD, English, 5.1 channels, 48kHz
   &quot;Surround 5.1&quot;
3: AC3, English, 5.1 channels, 448kbps, 48kHz, 24ms
   &quot;Surround 5.1&quot;
4: DTS Master Audio, Japanese, 5.1 channels, 24 bits, 48kHz
   (core: DTS, 5.1 channels, 1509kbps, 48kHz)
   &quot;Surround 5.1&quot;
5: Subtitle (PGS), English
6: Subtitle (PGS), English, &quot;Signs &amp; Songs&quot;
7: Subtitle (PGS), Japanese</code></pre>
</doc-codeblock></div>
<p>Now you can select, extract and convert them all at once by using the numbers corresponding to each track.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">eac3to ExampleAnime.mkv 2: &quot;ENG.5.1.flac&quot; 3: &quot;ENG.5.1.*&quot; 4: &quot;JPN.5.1.flac&quot;</code></pre>
</doc-codeblock></div>
<p>Batch command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">for %I in (*.mkv) do eac3to &quot;%I&quot; 2: &quot;%~nI.ENG.5.1.flac&quot; 3: &quot;%~nI.ENG.5.1.*&quot; 4: &quot;%~nI.JPN.5.1.flac&quot;</code></pre>
</doc-codeblock></div>
<p>Shell command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">for file in *.mkv; do eac3to &quot;${file}&quot; 2: &quot;${file%.*}.ENG.5.1.flac&quot; 3: &quot;${file%.*}.ENG.5.1.*&quot; 4: &quot;${file%.*}.JPN.5.1.flac&quot;; done
</code></pre>
</doc-codeblock></div>
<p>This will select the second and fourth tracks and transcode both of them losslessly to FLAC but the third lossy track will be extracted without any transcoding because no codec was specified.</p>
<p>For example:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">D:\MHA&gt;eac3to  &quot;My Hero Academia the Movie- The Heroes Rising 2018 1080p BluRay Hybrid-REMUX AVC TrueHD 5.1 Dual Audio -ZR-.mkv&quot; 2: &quot;English 5.1.flac&quot; 3: &quot;English 5.1.*&quot; 4: &quot;Japanese 5.1.flac&quot;
------------------------------------------------------------------------------
MKV, 1 video track, 3 audio tracks, 3 subtitle tracks, 1:44:09, 24p /1.001
1: h264/AVC, English, 1080p24 /1.001 (16:9)
2: TrueHD, English, 5.1 channels, 48kHz
   &quot;Surround 5.1&quot;
3: AC3, English, 5.1 channels, 448kbps, 48kHz, 24ms
   &quot;Surround 5.1&quot;
4: DTS Master Audio, Japanese, 5.1 channels, 24 bits, 48kHz
   (core: DTS, 5.1 channels, 1509kbps, 48kHz)
   &quot;Surround 5.1&quot;
5: Subtitle (PGS), English
6: Subtitle (PGS), English, &quot;Signs &amp; Songs&quot;
7: Subtitle (PGS), Japanese
[a02] Extracting audio track number 2...
[a03] Extracting audio track number 3...
[a04] Extracting audio track number 4...
[a02] Decoding with libav/ffmpeg...
[a03] Applying (E-)AC3 delay...
[a04] Decoding with libDcaDec DTS Decoder...
[a02] Encoding FLAC with libFlac...
[a03] A remaining delay of -8ms could not be fixed.
[a04] Encoding FLAC with libFlac...
[a02] Creating file &quot;English 5.1.flac&quot;...
[a03] Creating file &quot;English 5.1.ac3&quot;...
[a04] Creating file &quot;Japanese 5.1.flac&quot;...
[a02] Removing TrueHD dialog normalization...
[a02] Original audio track, L+R+C+SL+SR: max 20 bits, average 17 bits.
[a02] Original audio track, LFE: constant bit depth of 16 bits.
[a04] The original audio track has a constant bit depth of 24 bits.
Video track 1 contains 149592 frames.
eac3to processing took 7 minutes, 28 seconds.
Done.</code></pre>
</doc-codeblock></div>
<p>Here the second and fourth lossless tracks get transcoded to FLAC while the lossy AC3 track remains the same.</p>
<doc-anchor-target id="sox">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#sox">#</doc-anchor-trigger>
        <span>SoX</span>
    </h3>
</doc-anchor-target>
<p>If you&#x27;re planning to include lossless audio from the source, downconvert and dither 24-bit lossless tracks to 16-bit FLAC for the sake of reducing bloat as 24-bit is significantly larger with no benefits over 16-bit FLAC.</p>
<p>Here&#x27;s the recommended command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">sox input.flac -R -G -b 16 output.flac rate -v -L 48000 dither</code></pre>
</doc-codeblock></div>
<p>Batch command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">for %I in (*.flac) do sox &quot;%I&quot; -G -b 16 &quot;%~nI.flac&quot; rate -v -L 48000 dither</code></pre>
</doc-codeblock></div>
<p>Shell command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">for file in *.flac; do sox -S &quot;${file}&quot; -R -G -b 16 &quot;${file%.*}.flac&quot; rate -v -L 48000 dither; done</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="opus-tools">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#opus-tools">#</doc-anchor-trigger>
        <span>opus-tools</span>
    </h3>
</doc-anchor-target>
<p>If you&#x27;re planning to include lossy audio, it&#x27;s recommended to use Opus with a bitrate of 128-192Kb/s for Stereo tracks and 256-320Kb/s for multi-channel tracks to achieve transparency.</p>
<p>Here are the recommended commands:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">opusenc --bitrate 192 Stereo_track.flac Stereo_track.opus</code></pre>
</doc-codeblock></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">opusenc --bitrate 320 multichannel_track.flac multichannel_track.opus</code></pre>
</doc-codeblock></div>
<p>Batch command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">for %I in (*.flac) do opusenc --bitrate 192 &quot;%I&quot; &quot;%~nI.opus&quot;</code></pre>
</doc-codeblock></div>
<p>Shell command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">for file in *.flac; do opusenc --bitrate 192 &quot;${file}&quot; &quot;${file%.*}.opus&quot;; done</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="subtitles">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#subtitles">#</doc-anchor-trigger>
        <span>Subtitles</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="recommended-tools-1">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#recommended-tools-1">#</doc-anchor-trigger>
        <span>Recommended Tools</span>
    </h2>
</doc-anchor-target>
<ul>
<li><a href="https://github.com/arch1t3cht/Aegisub">arch1t3cht/Aegisub</a> for everything subtitle work.</li>
<li><a href="https://github.com/Myaamori/SubKt">SubKt</a> is a highly configurable toolkit for fansubbing automation.</li>
<li><a href="https://github.com/TypesettingTools/Myaamori-Aegisub-Scripts">Myaamori-Aegisub-Scripts</a> includes several helpful scripts for processing <code v-pre>.ASS</code> subtitles.</li>
<li><a href="https://github.com/tp7/Prass">Prass</a> is another Console processor for <code v-pre>.ASS</code> subtitles.</li>
<li><a href="https://github.com/tp7/Sushi">tp7/Sushi</a> is an automatic subtitle shifter based on audio.</li>
<li><a href="https://github.com/FichteFoll/Sushi">FichteFoll/Sushi</a> is the python 3 fork of <a href="https://github.com/tp7/Sushi">tp7/Sushi</a>.</li>
</ul>
<doc-anchor-target id="general-2">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#general-2">#</doc-anchor-trigger>
        <span>General</span>
    </h2>
</doc-anchor-target>
<ul>
<li>Multiple Subtitle tracks take negligible space and provide more options so there&#x27;s no reason not to include them.</li>
<li>Always include the official subtitle track.</li>
<li>Always include fansubs if they exist and are of good quality.</li>
<li><code v-pre>Honorifics</code> track must be tagged as <code v-pre>enm</code>.</li>
<li>Must include a <code v-pre>Signs and Songs</code> track for English dub.</li>
<li>It&#x27;s recommended to check the subtitle track for obvious grammatical errors, punctuation errors, typos, etc.</li>
<li>Check the subtitle tracks for scene bleeds, i.e, when something extends to a frame it shouldn&#x27;t.</li>
<li>Pick the default subtitle track by diffing the different options and finding the best one. This can be done via sites like <a href="https://www.diffchecker.com/">Diffchecker</a> or <a href="https://meitantei.org/public/evadiff/">evadiff</a>.</li>
<li>Here&#x27;s a <a href="https://github.com/TypesettingTools/Myaamori-Aegisub-Scripts#sub-digest">subdigest</a> script to get clean text file output of .ASS subtitles for diff checking:</li>
</ul>
<p>Batch command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">for %I in (*.ass) do python -m subdigest -i &quot;%I&quot; --selection-set &quot;text&quot; &quot;\\p&quot; --remove-selected --selection-set style &quot;Sign|OP|ED|op|ed|kfx|Karaoke|Eyecatch|Signs&quot; --remove-selected --remove-all-tags --remove-comments --get-field text -o &quot;%~nI.txt&quot;</code></pre>
</doc-codeblock></div>
<p>Shell command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">for file in *.ass do; python -m subdigest -i &quot;${file}&quot; --selection-set &quot;text&quot; &quot;\\p&quot; --remove-selected --selection-set style &quot;Sign|OP|ED|op|ed|kfx|Karaoke|Eyecatch|Signs&quot; --remove-selected --remove-all-tags --remove-comments --get-field text -o &quot;${file%.*}.txt&quot;; done</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="styling">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#styling">#</doc-anchor-trigger>
        <span>Styling</span>
    </h2>
</doc-anchor-target>
<ul>
<li>The dialogue style must be readable without being distracting.</li>
<li>Feel free to restyle bad styling. Here&#x27;s a reference for some good <a href="https://i.imgur.com/qQUFf7n.png">dialogue fonts</a>.</li>
<li>You can also copy styling from existing groups like <a href="https://nyaa.si/user/GoodJobMedia">GJM</a>, <a href="https://nyaa.si/user/Kaleido-subs">Kaleido</a>, or <a href="https://nyaa.si/user/DameDesuYo">DDY</a>.</li>
<li>Try to match the styling of previous seasons of the same show to maintain consistency. Although this isn&#x27;t mandatory and should be avoided if previous season releases had bad styling.</li>
</ul>
<doc-anchor-target id="advanced">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#advanced">#</doc-anchor-trigger>
        <span>Advanced</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="ordered-chaptersmkv-linking">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ordered-chaptersmkv-linking">#</doc-anchor-trigger>
        <span>Ordered Chapters/mkv linking</span>
    </h3>
</doc-anchor-target>
<p>On some releases(like coalgirls), the OP/ED are removed from the episodes and placed into separate files. These files are then linked to the appropriate position in the episodes where they are supposed to play. While this is a great idea to save space, unfortunately, it doesn&#x27;t work on a lot of players and the OP/ED is never played. If you notice this while watching anime, OCs are the most probable cause.</p>
<p><a href="https://mod16.org/hurfdurf/?p=8">Explanation for ordered chapters</a></p>
<p>Fix ordered chapters using <a href="https://github.com/gnoling/UnlinkMKV">UnlinkMKV</a></p>
<doc-anchor-target id="crc32">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#crc32">#</doc-anchor-trigger>
        <span>CRC32</span>
    </h3>
</doc-anchor-target>
<p>This is used to verify that the files you have are the correct ones, or whether they match with the version released by the uploader. CRCs will change if any part of the file changes, even if you only change one letter in one tag in the file. This allows us to identify files that were changed from the original source or corrupted at some point. However, just renaming the file will not change it. Apart from the numbers included within [] at the end of a filename, .sfv (CRC checksum) or .md5 (MD5 checksum) files can also be used for the same purpose. Sometimes a group makes mistakes and wants to correct them by releasing a second version(v2), in this case the changed CRC makes it easy to differentiate between multiple versions.</p>
<p>You can use <a href="http://animechecker.sourceforge.net/">Anime Checker</a> or <a href="https://www.ov2.eu/programs/rapidcrc-unicode">RapidCRC</a> to verify or add CRC to your files.</p>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results />
                            </div>
                            <footer class="clear-both">
                                <div class="flex flex-wrap items-center justify-between mt-14">
                                    <a class="my-2.5 inline-flex items-center text-sm whitespace-nowrap text-blue-500 dark:text-blue-400 hover:text-blue-700 hover:underline" href="https://github.com/snaacky/thewiki/blob/master/advanced/muxing.md" target="_blank" rel="noopener">
                                        <svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M20 12c-.55 0-1 .45-1 1v7c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h7c.55 0 1-.45 1-1s-.45-1-1-1H4C2.35 3 1 4.35 1 6v14c0 1.65 1.35 3 3 3h14c1.65 0 3-1.35 3-3v-7c0-.55-.45-1-1-1z" /><path d="M22.21 1.79c-1.18-1.18-3.24-1.18-4.41 0l-9.5 9.5c-.13.13-.22.29-.26.46l-1 4c-.08.34.01.7.26.95.18.2.44.3.7.3.08 0 .16-.01.24-.03l4-1c.18-.04.34-.13.46-.26l9.5-9.5c1.22-1.22 1.22-3.2.01-4.42zm-1.42 3l-9.3 9.3-2.11.53.53-2.11 9.3-9.3c.42-.42 1.16-.42 1.59 0 .43.43.43 1.15-.01 1.58z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        <span>Edit this page</span>
                                    </a>
                                </div>
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../advanced/encoding/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Encoding</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../advanced/release-standards/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Release Standards</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script>window.__DOCS__ = { "title": "Muxing", level: 2, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false }</script>
</body>
</html>
